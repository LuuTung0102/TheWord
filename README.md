# ğŸ“„ TheWord - Há»‡ Thá»‘ng Tá»± Äá»™ng HÃ³a Táº¡o VÄƒn Báº£n

## ğŸ“‹ Má»¥c Lá»¥c
- [Tá»•ng Quan](#-tá»•ng-quan)
- [TÃ­nh NÄƒng ChÃ­nh](#-tÃ­nh-nÄƒng-chÃ­nh)
- [TÃ­nh NÄƒng Má»›i](#-tÃ­nh-nÄƒng-má»›i-v60)
- [CÃ i Äáº·t](#-cÃ i-Ä‘áº·t)
- [HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng](#-hÆ°á»›ng-dáº«n-sá»­-dá»¥ng)
- [Kiáº¿n TrÃºc Há»‡ Thá»‘ng](#-kiáº¿n-trÃºc-há»‡-thá»‘ng)
- [CÃ´ng Nghá»‡](#-cÃ´ng-nghá»‡)

---

## ğŸ¯ Tá»•ng Quan

**TheWord** lÃ  há»‡ thá»‘ng tá»± Ä‘á»™ng hÃ³a táº¡o vÄƒn báº£n dá»±a trÃªn Electron, giÃºp táº¡o file Word tá»« template nhanh chÃ³ng vÃ  chÃ­nh xÃ¡c. ÄÆ°á»£c thiáº¿t káº¿ cho vÄƒn báº£n phÃ¡p lÃ½ vÃ  hÃ nh chÃ­nh vá»›i kháº£ nÄƒng quáº£n lÃ½ vÃ  tÃ¡i sá»­ dá»¥ng dá»¯ liá»‡u thÃ´ng minh.

### Quy TrÃ¬nh LÃ m Viá»‡c
```
Chá»n Folder Template â†’ Chá»n File .docx â†’ Äiá»n Form â†’ Xuáº¥t VÄƒn Báº£n âœ…
```

### 100% Offline
- KhÃ´ng cáº§n internet sau khi cÃ i Ä‘áº·t
- Dá»¯ liá»‡u lÆ°u trá»¯ local
- Kiá»ƒm soÃ¡t quyá»n riÃªng tÆ° hoÃ n toÃ n

### âš ï¸ LÆ°u Ã Quan Trá»ng
- **Chá»‰ há»— trá»£ Ä‘á»‹nh dáº¡ng .docx** (Word 2007+)
- **File .doc (Word 97-2003) KHÃ”NG hoáº¡t Ä‘á»™ng**
- Xem [Há»— Trá»£ Äá»‹nh Dáº¡ng File](#-há»—-trá»£-Ä‘á»‹nh-dáº¡ng-file) Ä‘á»ƒ biáº¿t cÃ¡ch chuyá»ƒn Ä‘á»•i

---

## âœ¨ TÃ­nh NÄƒng ChÃ­nh

### ğŸ“ Táº¡o Form ThÃ´ng Minh
- **Tá»± Ä‘á»™ng táº¡o form** tá»« placeholder trong template
- **15+ loáº¡i trÆ°á»ng**: text, number, date, select, address, money, land-type, HTSD, vÃ  nhiá»u hÆ¡n
- **Validation thÃ´ng minh** vá»›i pháº£n há»“i trá»±c quan vÃ  tá»± Ä‘á»™ng chuyá»ƒn tab
- **Tá»± Ä‘á»™ng format**: CCCD (9/12 sá»‘), Tiá»n (1,000,000), NgÃ y thÃ¡ng, Sá»‘ Ä‘iá»‡n thoáº¡i
- **Nháº­p Ä‘á»‹a chá»‰ linh hoáº¡t**: Tá»± Ä‘á»™ng gá»£i Ã½ tá»« database HOáº¶C nháº­p thá»§ cÃ´ng cho thÃ´n/xÃ³m


### ğŸ·ï¸ Há»‡ Thá»‘ng Loáº¡i Äáº¥t NÃ¢ng Cao
- **3 Ä‘á»‹nh dáº¡ng thÃ´ng minh**:
  - `Loai_Dat`: MÃ£ cÆ¡ báº£n (CLN+NST)
  - `Loai_Dat_F`: CÃ³ diá»‡n tÃ­ch (CLN 1236.5mÂ²)
  - `Loai_Dat_D`: Chi tiáº¿t vá»›i vá»‹ trÃ­ (CLN|Vá»‹ trÃ­|1236.5)
- **Tá»± Ä‘á»™ng Ä‘á»“ng bá»™** giá»¯a cÃ¡c Ä‘á»‹nh dáº¡ng
- **Chuyá»ƒn Ä‘á»•i tá»± Ä‘á»™ng** khi tÃ¡i sá»­ dá»¥ng giá»¯a cÃ¡c template

### ğŸ”„ Há»‡ Thá»‘ng HTSD (HÃ¬nh Thá»©c Sá»­ Dá»¥ng Äáº¥t) - Má»šI
- **2 cháº¿ Ä‘á»™ hiá»ƒn thá»‹**:
  - **Loáº¡i 1**: Dropdown (Sá»­ dá»¥ng chung/Sá»­ dá»¥ng riÃªng)
  - **Loáº¡i 2**: Nháº­p diá»‡n tÃ­ch (mÂ² Chung + mÂ² RiÃªng)
- **Toggle linh hoáº¡t**: Báº­t/táº¯t tá»«ng loáº¡i Ä‘á»™c láº­p hoáº·c cáº£ 2
- **Tá»± Ä‘á»™ng sync**: Thay Ä‘á»•i HTSD tá»± Ä‘á»™ng cáº­p nháº­t vÃ o session gá»‘c
- **Há»— trá»£ tÃ¡i sá»­ dá»¥ng**: Giá»¯ nguyÃªn printMode khi reuse data
- **Logic Ä‘áº·c biá»‡t**: KhÃ´ng áº£nh hÆ°á»Ÿng merge logic (giá»‘ng Loai_Dat_D)

### ğŸ—ºï¸ Há»‡ Thá»‘ng Äá»‹a Chá»‰ Linh Hoáº¡t
- **4 cáº¥p cascading**: Tá»‰nh â†’ XÃ£ â†’ ThÃ´n/XÃ³m â†’ ÄÆ°á»ng
- **HÃ nh vi dropdown thÃ´ng minh**:
  - Tá»‰nh & XÃ£: Pháº£i chá»n tá»« database
  - ThÃ´n/XÃ³m: **Chá»n tá»« danh sÃ¡ch HOáº¶C nháº­p thá»§ cÃ´ng** náº¿u khÃ´ng cÃ³
- **Tá»± Ä‘á»™ng gá»£i Ã½ vá»›i tÃ¬m kiáº¿m**: GÃµ Ä‘á»ƒ lá»c káº¿t quáº£ phÃ¹ há»£p
- **Äiá»u hÆ°á»›ng bÃ n phÃ­m**: Há»— trá»£ phÃ­m mÅ©i tÃªn, Enter, Tab
- **Báº£o toÃ n dá»¯ liá»‡u**: LÆ°u vÃ  khÃ´i phá»¥c Ä‘Ãºng cáº£ nháº­p thá»§ cÃ´ng
- **Há»— trá»£ tÃ¡i sá»­ dá»¥ng**: Táº¥t cáº£ thÃ nh pháº§n Ä‘á»‹a chá»‰ ká»ƒ cáº£ thÃ´n/xÃ³m thá»§ cÃ´ng

### ğŸ‘¥ Quáº£n LÃ½ Dá»¯ Liá»‡u NgÆ°á»i
- **LocalStorage** cho ngÆ°á»i thÆ°á»ng dÃ¹ng (PERSON1, PERSON2, ...)
- **CRUD Ä‘áº§y Ä‘á»§** vá»›i validation
- **Chá»n nhanh** vá»›i preview trá»±c quan
- **Tá»± Ä‘á»™ng táº¡o ID** vÃ  nhÃ£n tiáº¿ng Viá»‡t


### ğŸ”„ TÃ¡i Sá»­ Dá»¥ng Dá»¯ Liá»‡u ThÃ´ng Minh
- **SessionStorage** cho dá»¯ liá»‡u táº¡m vá»›i logic merge thÃ´ng minh
- **Tá»± Ä‘á»™ng khÃ´i phá»¥c** - tá»± Ä‘á»™ng lÆ°u vÃ  khÃ´i phá»¥c session khi khá»Ÿi Ä‘á»™ng láº¡i
- **Loáº¡i bá» trÃ¹ng láº·p** giá»¯a cÃ¡c file
- **3 chiáº¿n lÆ°á»£c merge**: NO_CHANGE, ONLY_ADDITIONS, HAS_MODIFICATIONS
- **Dropdown "TÃ¡i Sá»­ Dá»¥ng"** vá»›i timestamp Ä‘á»ƒ theo dÃµi phiÃªn báº£n dá»¯ liá»‡u
- **Sync thÃ´ng minh**: 
  - HTSD tá»± Ä‘á»™ng sync vá»›i session gá»‘c khi cÃ¹ng base type (INFO, INFO2, INFO3...)
  - Loai_Dat_D khÃ´ng áº£nh hÆ°á»Ÿng logic merge

### ğŸ—‚ï¸ Quáº£n LÃ½ Subgroup Äá»™ng
- **ThÃªm/XÃ³a** subgroup (ngÆ°á»i, pháº§n) Ä‘á»™ng
- **Kiá»ƒm soÃ¡t hiá»ƒn thá»‹** khÃ´ng máº¥t dá»¯ liá»‡u
- **Tá»± Ä‘á»™ng refresh** UI sau thay Ä‘á»•i
- **Dá»n dáº¹p event listener** Ä‘Ãºng cÃ¡ch Ä‘á»ƒ trÃ¡nh memory leak

### ğŸ“Š UI/UX ChuyÃªn Nghiá»‡p
- **Layout 2 mÃ u**: Panel xanh (nháº­p liá»‡u) + Panel cam (chá»n folder)
- **Taskbar navigation** Ä‘á»ƒ chuyá»ƒn section nhanh
- **Responsive design** cho má»i kÃ­ch thÆ°á»›c mÃ n hÃ¬nh
- **Toast notifications** thay tháº¿ alert/confirm cÅ©
- **Loading overlay** khi xuáº¥t file
- **Smart input fields**: Tá»± Ä‘á»™ng gá»£i Ã½ vá»›i fallback thá»§ cÃ´ng Ä‘á»ƒ linh hoáº¡t tá»‘i Ä‘a

### âš¡ Tá»‘i Æ¯u Hiá»‡u NÄƒng
- **Render form**: < 200ms
- **Validation**: < 50ms
- **Xuáº¥t file**: < 5 giÃ¢y
- **Sá»­ dá»¥ng RAM**: ~100-150MB vá»›i templates

### ğŸ›¡ï¸ Há»‡ Thá»‘ng Validation ThÃ´ng Minh
- **Highlight lá»—i trá»±c quan**: Viá»n Ä‘á» + ná»n há»“ng + animation rung
- **Tá»± Ä‘á»™ng chuyá»ƒn tab** Ä‘áº¿n vá»‹ trÃ­ lá»—i
- **Tá»± Ä‘á»™ng scroll & focus** Ä‘á»ƒ UX tá»‘t hÆ¡n
- **ThÃ´ng bÃ¡o lá»—i theo nhÃ³m** theo section
- **Tá»± Ä‘á»™ng xÃ³a** styling lá»—i khi user báº¯t Ä‘áº§u gÃµ
- **Regex constants** Ä‘á»ƒ validation nháº¥t quÃ¡n
- **Xá»­ lÃ½ Ä‘áº·c biá»‡t** cho trÆ°á»ng Ä‘á»‹a chá»‰ (4 cáº¥p dropdown)
- **Validation HTSD**: Kiá»ƒm tra printMode vÃ  value

---


## ğŸ†• TÃ­nh NÄƒng Má»›i (v6.0)

### 1. Há»‡ Thá»‘ng HTSD (HÃ¬nh Thá»©c Sá»­ Dá»¥ng Äáº¥t)
**Váº¥n Ä‘á» giáº£i quyáº¿t:** Cáº§n nháº­p hÃ¬nh thá»©c sá»­ dá»¥ng Ä‘áº¥t linh hoáº¡t vá»›i 2 cÃ¡ch hiá»ƒn thá»‹ khÃ¡c nhau

**TÃ­nh nÄƒng:**
- **Dual-mode input**: 
  - Loáº¡i 1: Dropdown chá»n "Sá»­ dá»¥ng chung" hoáº·c "Sá»­ dá»¥ng riÃªng"
  - Loáº¡i 2: Nháº­p diá»‡n tÃ­ch mÂ² Chung vÃ  mÂ² RiÃªng
- **Toggle buttons**: Báº­t/táº¯t tá»«ng loáº¡i Ä‘á»™c láº­p
- **Smart sync**: Tá»± Ä‘á»™ng cáº­p nháº­t vÃ o session gá»‘c khi thay Ä‘á»•i
- **Base type matching**: INFO, INFO2, INFO3... Ä‘á»u sync vá»›i nhau
- **KhÃ´ng áº£nh hÆ°á»Ÿng merge**: Giá»‘ng Loai_Dat_D, khÃ´ng tham gia phÃ¢n tÃ­ch merge

**CÃ¡ch sá»­ dá»¥ng:**
```
1. ThÃªm placeholder {{HTSD}} vÃ o template Word
2. Form tá»± Ä‘á»™ng táº¡o HTSD field vá»›i 2 toggle buttons
3. Báº­t Loáº¡i 1 Ä‘á»ƒ nháº­p dropdown
4. Báº­t Loáº¡i 2 Ä‘á»ƒ nháº­p diá»‡n tÃ­ch
5. CÃ³ thá»ƒ báº­t cáº£ 2 Ä‘á»ƒ xuáº¥t cáº£ 2 loáº¡i
6. Khi tÃ¡i sá»­ dá»¥ng, HTSD tá»± Ä‘á»™ng sync vá»›i session gá»‘c
```

**VÃ­ dá»¥ output:**
- Loáº¡i 1: "Sá»­ dá»¥ng chung"
- Loáº¡i 2: "1500mÂ² Chung; 250mÂ² RiÃªng"
- Both: "Sá»­ dá»¥ng chung|1500|250"

### 2. Tá»± Äá»™ng KhÃ´i Phá»¥c Session
**Váº¥n Ä‘á» giáº£i quyáº¿t:** Máº¥t dá»¯ liá»‡u khi app bá»‹ táº¯t Ä‘á»™t ngá»™t hoáº·c crash

**TÃ­nh nÄƒng:**
- **Auto-save**: Tá»± Ä‘á»™ng lÆ°u session vÃ o localStorage trÆ°á»›c khi Ä‘Ã³ng app
- **Restore modal**: Há»i ngÆ°á»i dÃ¹ng khi khá»Ÿi Ä‘á»™ng láº¡i: "KhÃ´i phá»¥c" hoáº·c "LÃ m má»›i"
- **Preserve work**: Giá»¯ nguyÃªn toÃ n bá»™ cÃ´ng viá»‡c náº¿u app crash
- **Disable option**: CÃ³ thá»ƒ táº¯t báº±ng `localStorage.setItem('disable_auto_restore', 'true')`

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
```
1. User Ä‘ang lÃ m viá»‡c â†’ App táº¯t Ä‘á»™t ngá»™t
2. Má»Ÿ láº¡i app â†’ Modal hiá»‡n lÃªn
3. Chá»n "KhÃ´i phá»¥c" â†’ Dá»¯ liá»‡u Ä‘Æ°á»£c load láº¡i
4. Chá»n "LÃ m má»›i" â†’ Báº¯t Ä‘áº§u session má»›i
```

### 3. Nháº­p ThÃ´n/XÃ³m Thá»§ CÃ´ng
**Váº¥n Ä‘á» giáº£i quyáº¿t:** Nhiá»u thÃ´n/xÃ³m khÃ´ng cÃ³ trong database

**TÃ­nh nÄƒng:**
- **Flexible input**: Chá»n tá»« dropdown HOáº¶C nháº­p thá»§ cÃ´ng
- **Smart placeholder**: "Chá»n hoáº·c nháº­p thÃ´n/xÃ³m..."
- **Data preservation**: LÆ°u vÃ  khÃ´i phá»¥c Ä‘Ãºng cáº£ nháº­p thá»§ cÃ´ng
- **Reuse support**: TÃ¡i sá»­ dá»¥ng hoáº¡t Ä‘á»™ng vá»›i cáº£ manual entries

**CÃ¡ch sá»­ dá»¥ng:**
```
1. Chá»n Tá»‰nh vÃ  XÃ£
2. TrÆ°á»ng ThÃ´n/XÃ³m active
3. Náº¿u cÃ³ trong database â†’ Chá»n tá»« dropdown
4. Náº¿u khÃ´ng cÃ³ â†’ GÃµ trá»±c tiáº¿p tÃªn thÃ´n/xÃ³m
5. Enter hoáº·c Tab Ä‘á»ƒ chuyá»ƒn field tiáº¿p theo
```


### 4. Smart Session Merge Logic
**Váº¥n Ä‘á» giáº£i quyáº¿t:** Xung Ä‘á»™t dá»¯ liá»‡u khi tÃ¡i sá»­ dá»¥ng vÃ  chá»‰nh sá»­a

**TÃ­nh nÄƒng:**
- **3-level analysis**: NO_CHANGE, ONLY_ADDITIONS, HAS_MODIFICATIONS
- **Cross-file deduplication**: Tá»± Ä‘á»™ng loáº¡i bá» dá»¯ liá»‡u trÃ¹ng láº·p
- **Versioned keys**: Táº¡o timestamp key khi cÃ³ modification
- **Smart merge**: Merge ONLY_ADDITIONS, táº¡o version má»›i cho MODIFICATIONS
- **Special fields**: HTSD vÃ  Loai_Dat_D khÃ´ng áº£nh hÆ°á»Ÿng merge logic

**Logic hoáº¡t Ä‘á»™ng:**
```
TÃ¡i sá»­ dá»¥ng INFO:
â”œâ”€ KhÃ´ng thay Ä‘á»•i â†’ NO_CHANGE â†’ KhÃ´ng táº¡o session má»›i
â”œâ”€ ThÃªm field má»›i â†’ ONLY_ADDITIONS â†’ Merge vÃ o INFO gá»‘c
â”œâ”€ Sá»­a field cÅ© â†’ HAS_MODIFICATIONS â†’ Táº¡o INFO_timestamp má»›i
â””â”€ Sá»­a HTSD â†’ KhÃ´ng coi lÃ  modification â†’ Sync vá»›i INFO gá»‘c
```

### 5. Base Type Matching cho HTSD
**Váº¥n Ä‘á» giáº£i quyáº¿t:** INFO vÃ  INFO2 khÃ´ng sync HTSD vá»›i nhau

**TÃ­nh nÄƒng:**
- **Base type comparison**: So sÃ¡nh base type thay vÃ¬ exact match
- **Smart grouping**: INFO, INFO2, INFO3... Ä‘á»u lÃ  base type "INFO"
- **Cross-suffix sync**: Thay Ä‘á»•i HTSD trong INFO2 â†’ Sync vá»›i INFO gá»‘c
- **Type isolation**: INFO vÃ  MEN khÃ´ng sync vá»›i nhau (khÃ¡c base type)

**VÃ­ dá»¥:**
```
File A: INFO cÃ³ HTSD = "Sá»­ dá»¥ng riÃªng"
File A: INFO2 cÃ³ HTSD = "Sá»­ dá»¥ng chung"
File B: TÃ¡i sá»­ dá»¥ng INFO2 cho form INFO
       â†’ Sá»­a HTSD thÃ nh "Sá»­ dá»¥ng riÃªng"
       â†’ INFO2 trong File A cÅ©ng thÃ nh "Sá»­ dá»¥ng riÃªng" (sync)
```

### 6. Improved Validation System
**Váº¥n Ä‘á» giáº£i quyáº¿t:** Validation khÃ´ng rÃµ rÃ ng, khÃ³ tÃ¬m lá»—i

**TÃ­nh nÄƒng:**
- **Visual feedback**: Red border + pink background + shake animation
- **Auto navigation**: Tá»± Ä‘á»™ng chuyá»ƒn tab vÃ  scroll Ä‘áº¿n lá»—i Ä‘áº§u tiÃªn
- **Grouped errors**: Lá»—i Ä‘Æ°á»£c nhÃ³m theo section/subgroup
- **Auto-clear**: XÃ³a styling lá»—i khi user báº¯t Ä‘áº§u gÃµ
- **HTSD validation**: Kiá»ƒm tra printMode (khÃ´ng Ä‘Æ°á»£c "both") vÃ  value

**Error types:**
```
- Required field empty
- CCCD format invalid (pháº£i 9 hoáº·c 12 sá»‘)
- Phone format invalid (pháº£i 10 sá»‘)
- Email format invalid
- Address incomplete (thiáº¿u Tá»‰nh hoáº·c XÃ£)
- HTSD printMode = "both" (khÃ´ng há»£p lá»‡)
- HTSD khÃ´ng cÃ³ printMode
```

---


## ğŸ”§ CÃ i Äáº·t

### YÃªu Cáº§u Há»‡ Thá»‘ng
- Node.js >= 14.x
- npm >= 6.x
- 4GB RAM (khuyáº¿n nghá»‹ 8GB)
- 500MB dung lÆ°á»£ng trá»‘ng
- **Template Word pháº£i Ä‘á»‹nh dáº¡ng .docx** (khÃ´ng pháº£i .doc)

### CÃ i Äáº·t Nhanh

```bash
# Clone repository
git clone https://github.com/LuuTung0102/TheWord.git
cd TheWord

# CÃ i Ä‘áº·t dependencies
npm install

# Cháº¡y á»©ng dá»¥ng
npm start
```

### Build Production

```bash
# Windows
npm run build:win

# macOS
npm run build:mac

# Linux
npm run build:linux
```

---

## ğŸ“– HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

### 1. Chá»n Folder Template
1. Má»Ÿ TheWord
2. Panel bÃªn pháº£i (mÃ u cam): Chá»n folder template
3. Há»‡ thá»‘ng tá»± Ä‘á»™ng load táº¥t cáº£ file **.docx** trong folder
   - **LÆ°u Ã½**: Chá»‰ há»— trá»£ .docx, khÃ´ng há»— trá»£ .doc

### 2. Chá»n File Word
1. Click folder Ä‘á»ƒ má»Ÿ rá»™ng vÃ  xem cÃ¡c file
2. Click file Ä‘á»ƒ chá»n
3. Form tá»± Ä‘á»™ng táº¡o tá»« placeholder trong file

### 3. Äiá»n Form
1. Panel bÃªn trÃ¡i (mÃ u xanh): Äiá»n táº¥t cáº£ trÆ°á»ng báº¯t buá»™c
2. Sá»­ dá»¥ng tÃ­nh nÄƒng thÃ´ng minh:
   - **Date Picker**: Click field Ä‘á»ƒ chá»n ngÃ y
   - **Address Select**: 4 cáº¥p cascading dropdown vá»›i nháº­p thá»§ cÃ´ng
     - Tá»‰nh & XÃ£: Chá»n tá»« dropdown
     - ThÃ´n/XÃ³m: Chá»n tá»« dropdown HOáº¶C gÃµ thá»§ cÃ´ng náº¿u khÃ´ng cÃ³
   - **Land Type**: Dropdown vá»›i autocomplete
   - **HTSD**: Toggle Loáº¡i 1 (dropdown) hoáº·c Loáº¡i 2 (diá»‡n tÃ­ch)
   - **CCCD**: Tá»± Ä‘á»™ng format khi gÃµ
   - **Money**: Tá»± Ä‘á»™ng format vá»›i dáº¥u pháº©y ngÄƒn cÃ¡ch

### 4. Sá»­ Dá»¥ng HTSD (HÃ¬nh Thá»©c Sá»­ Dá»¥ng Äáº¥t)
1. TÃ¬m field "HÃ¬nh thá»©c sá»­ dá»¥ng Ä‘áº¥t"
2. **Loáº¡i 1** (Dropdown):
   - Click toggle "Loáº¡i 1"
   - Chá»n "Sá»­ dá»¥ng chung" hoáº·c "Sá»­ dá»¥ng riÃªng"
3. **Loáº¡i 2** (Diá»‡n tÃ­ch):
   - Click toggle "Loáº¡i 2"
   - Nháº­p mÂ² Chung vÃ  mÂ² RiÃªng
4. **Cáº£ 2**: Báº­t cáº£ 2 toggle Ä‘á»ƒ xuáº¥t cáº£ 2 loáº¡i
5. Khi tÃ¡i sá»­ dá»¥ng, HTSD tá»± Ä‘á»™ng sync vá»›i session gá»‘c


### 5. TÃ¡i Sá»­ Dá»¥ng Dá»¯ Liá»‡u (Optional)
1. TÃ¬m dropdown "TÃ¡i Sá»­ Dá»¥ng"
2. Chá»n tá»« dá»¯ liá»‡u trÆ°á»›c hoáº·c ngÆ°á»i Ä‘Ã£ lÆ°u
3. Form tá»± Ä‘á»™ng Ä‘iá»n vá»›i dá»¯ liá»‡u Ä‘Ã£ chá»n
4. Chá»‰nh sá»­a náº¿u cáº§n
5. **HTSD tá»± Ä‘á»™ng sync**: Thay Ä‘á»•i HTSD sáº½ cáº­p nháº­t vÃ o session gá»‘c

### 6. Quáº£n LÃ½ NgÆ°á»i (Optional)
1. Click "âš™ï¸ Quáº£n LÃ½" á»Ÿ header
2. Chá»n "ğŸ‘¥ Quáº£n LÃ½ Dá»¯ Liá»‡u"
3. ThÃªm/Sá»­a/XÃ³a ngÆ°á»i
4. Há» xuáº¥t hiá»‡n Ä‘á»ƒ chá»n nhanh trong form

### 7. Xuáº¥t VÄƒn Báº£n
1. Kiá»ƒm tra táº¥t cáº£ trÆ°á»ng báº¯t buá»™c Ä‘Ã£ Ä‘iá»n
2. Click "ğŸ“¤ XUáº¤T WORD"
3. Chá»n thÆ° má»¥c lÆ°u
4. Äá»£i xá»­ lÃ½ (< 5 giÃ¢y)
5. Dialog thÃ nh cÃ´ng vá»›i tÃ¹y chá»n má»Ÿ thÆ° má»¥c

---

## ğŸ—ºï¸ HÆ°á»›ng Dáº«n Nháº­p Äá»‹a Chá»‰

### CÃ¡ch Sá»­ Dá»¥ng TrÆ°á»ng Äá»‹a Chá»‰

**Chá»n Tá»‰nh:**
1. Click hoáº·c focus vÃ o trÆ°á»ng Tá»‰nh
2. GÃµ Ä‘á»ƒ tÃ¬m kiáº¿m (vÃ­ dá»¥: "Äáº¯k Láº¯k")
3. DÃ¹ng phÃ­m mÅ©i tÃªn Ä‘á»ƒ Ä‘iá»u hÆ°á»›ng gá»£i Ã½
4. Enter hoáº·c click Ä‘á»ƒ chá»n

**Chá»n XÃ£:**
1. Sau khi chá»n Tá»‰nh, trÆ°á»ng XÃ£ active
2. GÃµ Ä‘á»ƒ tÃ¬m trong tá»‰nh Ä‘Ã£ chá»n
3. Chá»n tá»« dropdown

**Nháº­p ThÃ´n/XÃ³m (Linh Hoáº¡t):**
1. Sau khi chá»n XÃ£, trÆ°á»ng ThÃ´n/XÃ³m active
2. **TÃ¹y chá»n A - Chá»n tá»« danh sÃ¡ch:**
   - Náº¿u xÃ£ cÃ³ thÃ´n/xÃ³m trong database, dropdown hiá»‡n gá»£i Ã½
   - GÃµ Ä‘á»ƒ lá»c, chá»n tá»« danh sÃ¡ch
3. **TÃ¹y chá»n B - Nháº­p thá»§ cÃ´ng:**
   - Náº¿u khÃ´ng cÃ³ gá»£i Ã½ HOáº¶C thÃ´n/xÃ³m khÃ´ng cÃ³ trong danh sÃ¡ch
   - ÄÆ¡n giáº£n gÃµ tÃªn thÃ´n/xÃ³m trá»±c tiáº¿p
   - Enter hoáº·c Tab Ä‘á»ƒ chuyá»ƒn field tiáº¿p theo
4. **Nháº­p thá»§ cÃ´ng sáº½ Ä‘Æ°á»£c lÆ°u** vÃ  cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng sau

**Máº¹o:**
- DÃ¹ng Tab Ä‘á»ƒ chuyá»ƒn nhanh giá»¯a cÃ¡c trÆ°á»ng
- Esc Ä‘á»ƒ Ä‘Ã³ng dropdown
- Nháº­p thÃ´n/xÃ³m thá»§ cÃ´ng Ä‘Æ°á»£c há»— trá»£ Ä‘áº§y Ä‘á»§ trong tÃ¡i sá»­ dá»¥ng
- Äá»‹nh dáº¡ng Ä‘á»‹a chá»‰ lÆ°u: "ThÃ´n/XÃ³m, XÃ£, Tá»‰nh"

---


## ğŸ—ï¸ Kiáº¿n TrÃºc Há»‡ Thá»‘ng

### Cáº¥u TrÃºc Project
```
TheWord/
â”œâ”€â”€ renderer/
â”‚   â”œâ”€â”€ config/              # Constants & configuration
â”‚   â”‚   â”œâ”€â”€ baseConstants.js
â”‚   â”‚   â”œâ”€â”€ regexConstants.js
â”‚   â”‚   â”œâ”€â”€ config.json
â”‚   â”‚   â”œâ”€â”€ local_storage.json
â”‚   â”‚   â”œâ”€â”€ land_types.json
â”‚   â”‚   â””â”€â”€ address.json
â”‚   â”œâ”€â”€ core/                # Core services
â”‚   â”‚   â”œâ”€â”€ stateManager.js
â”‚   â”‚   â”œâ”€â”€ formValidator.js
â”‚   â”‚   â”œâ”€â”€ notificationManager.js
â”‚   â”‚   â”œâ”€â”€ personDataService.js
â”‚   â”‚   â”œâ”€â”€ sessionStorageManager.js  â† Smart merge & HTSD sync
â”‚   â”‚   â””â”€â”€ ... (utilities khÃ¡c)
â”‚   â”œâ”€â”€ handlers/            # UI handlers
â”‚   â”‚   â”œâ”€â”€ genericFormHandler.js
â”‚   â”‚   â”œâ”€â”€ exportHandler.js
â”‚   â”‚   â”œâ”€â”€ fileManager.js
â”‚   â”‚   â”œâ”€â”€ personManager.js
â”‚   â”‚   â””â”€â”€ ... (handlers khÃ¡c)
â”‚   â””â”€â”€ mainApp.js           # Main application
â”œâ”€â”€ logic/
â”‚   â”œâ”€â”€ generate.js          # Word document generation
â”‚   â””â”€â”€ placeholder.js       # Placeholder extraction
â”œâ”€â”€ templates/               # Template folders vá»›i configs
â”œâ”€â”€ index.html               # Main HTML
â”œâ”€â”€ main.js                  # Electron main process
â””â”€â”€ style.css                # Styles
```

### Luá»“ng Dá»¯ Liá»‡u

**Render Form:**
1. User chá»n template file
2. `templateManager.js` load config
3. `genericFormHandler.js` render form fields
4. Setup event listeners cho táº¥t cáº£ inputs
5. Auto-load session data trÆ°á»›c náº¿u cÃ³

**Validation Flow:**
1. User click "Xuáº¥t Word"
2. `formValidator.js` thu tháº­p vÃ  validate form data
3. Náº¿u cÃ³ lá»—i:
   - Highlight error fields (viá»n Ä‘á» + ná»n há»“ng)
   - Hiá»‡n grouped error notification
   - Tá»± Ä‘á»™ng chuyá»ƒn Ä‘áº¿n tab lá»—i Ä‘áº§u tiÃªn
   - Smooth scroll Ä‘áº¿n field lá»—i Ä‘áº§u tiÃªn
4. Náº¿u há»£p lá»‡, tiáº¿n hÃ nh export

**Export Flow:**
1. Thu tháº­p form data tá»« táº¥t cáº£ inputs
2. Xá»­ lÃ½ data (auto-convert, format, cleanup)
3. LÆ°u vÃ o session storage vá»›i smart merge
4. Gá»i `logic/generate.js` Ä‘á»ƒ táº¡o Word file
5. Hiá»‡n success notification vá»›i tÃ¹y chá»n má»Ÿ folder

**Data Reuse Flow:**
1. Khi export, session storage lÆ°u data vá»›i merge logic
2. Form tiáº¿p theo hiá»‡n dropdown "TÃ¡i Sá»­ Dá»¥ng" vá»›i saved data
3. Chá»n dropdown option Ä‘á»ƒ auto-fill form
4. Auto-convert land types Ä‘á»ƒ match template format
5. HTSD tá»± Ä‘á»™ng sync vá»›i session gá»‘c khi thay Ä‘á»•i


### Session Storage Manager - Chi Tiáº¿t

**Smart Merge Logic:**
```javascript
analyzeChanges(sourceData, currentData) {
  // Bá» qua HTSD vÃ  Loai_Dat_D (khÃ´ng áº£nh hÆ°á»Ÿng merge)
  // So sÃ¡nh cÃ¡c field khÃ¡c
  // Return: NO_CHANGE | ONLY_ADDITIONS | HAS_MODIFICATIONS
}
```

**HTSD Sync Logic:**
```javascript
// Khi tÃ¡i sá»­ dá»¥ng vÃ  chá»‰nh sá»­a HTSD:
1. Thu tháº­p HTSD value vÃ  printMode tá»« DOM
2. So sÃ¡nh base type (INFO, INFO2 â†’ cÃ¹ng base "INFO")
3. Náº¿u cÃ¹ng base type â†’ Sync vá»›i session gá»‘c
4. Náº¿u khÃ¡c base type â†’ KhÃ´ng sync
```

**Merge Strategy:**
```
NO_CHANGE:
  â†’ KhÃ´ng táº¡o session má»›i
  â†’ Reference Ä‘áº¿n data gá»‘c

ONLY_ADDITIONS:
  â†’ Merge vÃ o session gá»‘c
  â†’ KhÃ´ng táº¡o versioned key

HAS_MODIFICATIONS:
  â†’ Táº¡o versioned key má»›i (GROUP_timestamp)
  â†’ Giá»¯ nguyÃªn data gá»‘c
```

---

## ğŸ“ Há»— Trá»£ Äá»‹nh Dáº¡ng File

### âœ… Äá»‹nh Dáº¡ng Há»— Trá»£
- **.docx** (Office Open XML) - Word 2007 trá»Ÿ lÃªn
- ÄÃ¢y lÃ  **DUY NHáº¤T** Ä‘á»‹nh dáº¡ng Ä‘Æ°á»£c há»— trá»£

### âŒ KHÃ”NG Há»— Trá»£
- **.doc** (Office 97-2003 Binary Format)
- **.rtf** (Rich Text Format)
- **.odt** (OpenDocument Text)
- **.pdf** (Portable Document Format)

### Táº¡i Sao Chá»‰ .docx?
1. **Chuáº©n hiá»‡n Ä‘áº¡i**: .docx lÃ  chuáº©n Microsoft Word tá»« 2007
2. **Dá»±a trÃªn XML**: .docx lÃ  ZIP archive chá»©a XML, dá»… parse vÃ  modify
3. **Há»— trá»£ thÆ° viá»‡n**: Docxtemplater chá»‰ há»— trá»£ .docx
4. **TÃ­nh nÄƒng tá»‘t hÆ¡n**: .docx há»— trá»£ nhiá»u tÃ­nh nÄƒng vÃ  Ä‘Ã¡ng tin cáº­y hÆ¡n .doc cÅ©

### CÃ¡ch Chuyá»ƒn Äá»•i .doc sang .docx

**DÃ¹ng Microsoft Word:**
1. Má»Ÿ file .doc trong Microsoft Word
2. Click **File** â†’ **Save As**
3. Chá»n **Word Document (*.docx)** tá»« dropdown format
4. Click **Save**

**DÃ¹ng LibreOffice (Miá»…n phÃ­):**
1. Táº£i vÃ  cÃ i Ä‘áº·t [LibreOffice](https://www.libreoffice.org/)
2. Má»Ÿ file .doc trong LibreOffice Writer
3. Click **File** â†’ **Save As**
4. Chá»n **Office Open XML Text (.docx)** tá»« dropdown format
5. Click **Save**

**Chuyá»ƒn Ä‘á»•i hÃ ng loáº¡t:**
- DÃ¹ng tÃ­nh nÄƒng batch conversion cá»§a Microsoft Word
- Hoáº·c dÃ¹ng online converters (cáº©n tháº­n vá»›i vÄƒn báº£n nháº¡y cáº£m)

---


## ğŸ’» CÃ´ng Nghá»‡

### Core
- **Electron** 38.2.2 - Desktop application framework
- **Node.js** - Runtime environment
- **Vanilla JavaScript** - KhÃ´ng dependencies framework

### Document Processing
- **Docxtemplater** 3.66.7 - Word template engine (**.docx only**)
- **PizZip** 3.2.0 - ZIP file handling cho .docx archives
- **SAX** 1.4.3 - XML streaming parser
- **xmldom** 0.6.0 - XML DOM parser

### UI Components
- **Flatpickr** 4.6.13 - Date picker vá»›i Vietnamese locale
- **Custom CSS** - Responsive design system

### Utilities
- **adm-zip** 0.5.16 - ZIP archive creation
- **angular-expressions** 1.5.1 - Expression parser

---

## ğŸ› Troubleshooting

### Há»‡ thá»‘ng chá»‰ cháº¥p nháº­n file .docx, khÃ´ng pháº£i .doc
- **TheWord chá»‰ há»— trá»£ Ä‘á»‹nh dáº¡ng .docx** (Office Open XML)
- **File .doc (Office 97-2003) KHÃ”NG Ä‘Æ°á»£c há»— trá»£**
- **Giáº£i phÃ¡p**: Chuyá»ƒn Ä‘á»•i .doc sang .docx:
  - Má»Ÿ file .doc trong Microsoft Word
  - File â†’ Save As â†’ Chá»n "Word Document (*.docx)"
  - Hoáº·c dÃ¹ng LibreOffice Writer (miá»…n phÃ­) Ä‘á»ƒ chuyá»ƒn Ä‘á»•i

### Form khÃ´ng Ä‘iá»n Ä‘Ãºng
- Placeholder cÃ³ thá»ƒ bá»‹ tÃ¡ch ra nhiá»u text runs trong Word
- Giáº£i phÃ¡p: XÃ³a vÃ  gÃµ láº¡i placeholder khÃ´ng format
- KhÃ´ng dÃ¹ng bold/italic trÃªn placeholder

### Lá»—i validation CCCD
- Pháº£i chÃ­nh xÃ¡c 9 hoáº·c 12 sá»‘
- Giáº£i phÃ¡p: XÃ³a táº¥t cáº£ kÃ½ tá»± khÃ´ng pháº£i sá»‘
- Auto-formatting xáº£y ra khi nháº­p

### Session data khÃ´ng lÆ°u
- Kiá»ƒm tra browser localStorage Ä‘Ã£ báº­t
- XÃ³a cache vÃ  khá»Ÿi Ä‘á»™ng láº¡i app
- Kiá»ƒm tra dung lÆ°á»£ng Ä‘Ä©a cÃ²n trá»‘ng

### ThÃ´n/xÃ³m khÃ´ng Ä‘iá»n khi tÃ¡i sá»­ dá»¥ng
- Äáº£m báº£o xÃ£ Ä‘Ã£ Ä‘Æ°á»£c chá»n trÆ°á»›c
- Nháº­p thÃ´n/xÃ³m thá»§ cÃ´ng giá» Ä‘Ã£ Ä‘Æ°á»£c há»— trá»£ Ä‘áº§y Ä‘á»§
- Kiá»ƒm tra Ä‘á»‹nh dáº¡ng address string Ä‘Ãºng (ThÃ´n/XÃ³m, XÃ£, Tá»‰nh)

### HTSD khÃ´ng sync
- Kiá»ƒm tra base type cÃ³ giá»‘ng nhau khÃ´ng (INFO vs INFO2 â†’ OK, INFO vs MEN â†’ KhÃ´ng)
- Äáº£m báº£o Ä‘Ã£ báº­t Ã­t nháº¥t 1 toggle (Loáº¡i 1 hoáº·c Loáº¡i 2)
- Kiá»ƒm tra printMode khÃ´ng pháº£i "both" (khÃ´ng há»£p lá»‡)

### Export ráº¥t cháº­m
- Template lá»›n (> 50MB) máº¥t nhiá»u thá»i gian hÆ¡n
- ÄÃ³ng cÃ¡c á»©ng dá»¥ng khÃ´ng dÃ¹ng
- DÃ¹ng SSD Ä‘á»ƒ I/O file nhanh hÆ¡n

---


## ğŸ“ Lá»‹ch Sá»­ PhiÃªn Báº£n

### v6.0 - HTSD System & Smart Session Sync (Current)
- **Há»‡ thá»‘ng HTSD** vá»›i dual-mode input (Loáº¡i 1 + Loáº¡i 2)
- **Smart HTSD sync** vá»›i base type matching
- **Tá»± Ä‘á»™ng khÃ´i phá»¥c session** khi khá»Ÿi Ä‘á»™ng láº¡i
- **Nháº­p thÃ´n/xÃ³m thá»§ cÃ´ng** khi khÃ´ng cÃ³ trong database
- **Improved validation** vá»›i HTSD printMode check
- **Base type comparison** cho cross-suffix sync (INFO, INFO2, INFO3...)
- **Special field handling**: HTSD vÃ  Loai_Dat_D khÃ´ng áº£nh hÆ°á»Ÿng merge logic

### v5.6 - Flexible Village Input System
- **Manual village input** khi khÃ´ng cÃ³ trong database
- **Smart dropdown behavior**: Hiá»‡n gá»£i Ã½ khi cÃ³, cho phÃ©p gÃµ khi khÃ´ng
- **Improved data reuse**: Village values Ä‘Æ°á»£c báº£o toÃ n Ä‘Ãºng khi reuse
- **Better UX**: Cáº­p nháº­t placeholder "Chá»n hoáº·c nháº­p thÃ´n/xÃ³m..."
- **No data loss**: Manual entries Ä‘Æ°á»£c lÆ°u vÃ  khÃ´i phá»¥c Ä‘Ãºng

### v5.5 - Smart Land Type Storage & Auto-Conversion
- ÄÆ¡n giáº£n hÃ³a logic loáº¡i Ä‘áº¥t vá»›i auto 3-format generation
- Smart conversion dá»±a trÃªn template type
- KhÃ´ng máº¥t dá»¯ liá»‡u khi reuse
- Cáº£i thiá»‡n session merge strategy

### v5.4 - Enhanced Reuse Dropdown & Land Type Conversion
- Fixed dropdown event listener management
- Smart land type conversion giá»¯a cÃ¡c formats
- Improved UI vá»›i styling vÃ  animations tá»‘t hÆ¡n
- Better responsiveness khi chuyá»ƒn tab

### v5.3 - Smart Validation System
- Visual error highlighting vá»›i animations
- Auto tab switching Ä‘áº¿n vá»‹ trÃ­ lá»—i
- Regex constants centralization
- DOM element caching (70% cáº£i thiá»‡n hiá»‡u nÄƒng)
- Address field special handling

### v5.2 - Notification System Overhaul
- Professional toast notifications
- Confirm dialogs vá»›i overlay
- HTML-safe notification system
- Auto-dismiss vá»›i manual close option

### v5.1 - File Manager & Config Wizard
- Auto placeholder detection vÃ  classification
- Smart config generation
- File manager vá»›i add/delete/view
- Session storage vá»›i smart merge logic

### v5.0 - Person Management System
- LocalStorage cho quáº£n lÃ½ ngÆ°á»i
- CRUD operations vá»›i validation
- Auto-generate IDs vÃ  names
- Label management báº±ng tiáº¿ng Viá»‡t

### v4.0+ - Previous versions
- Session storage vÃ  data reuse
- Land type detail system (D/F/Basic formats)
- Dynamic subgroup management

---

## ğŸ¤ Contributing

1. Fork repository
2. Táº¡o feature branch (`git checkout -b feature/YourFeature`)
3. Commit changes (`git commit -m 'Add YourFeature'`)
4. Push to branch (`git push origin feature/YourFeature`)
5. Má»Ÿ Pull Request

---

## ğŸ“„ License

ISC License - Xem file LICENSE Ä‘á»ƒ biáº¿t chi tiáº¿t

---

## ğŸ‘¨â€ğŸ’» TÃ¡c Giáº£

**LuuTung0102**
- GitHub: [@LuuTung0102](https://github.com/LuuTung0102)

---


**Made with â¤ï¸ by LuuTung0102**
